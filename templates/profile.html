{% extends "page.html" %}
{% block content %}
    <div id="profilePage">
        <div id="profileInfo">
            <h1>Hei, {{ request.user.firstname }}!</h1>
            <h3>Din kontaktinformasjon:</h3>
            <p>Epost: {{ request.user }}</p>
            <p>Telefon: {{ request.user.phone }}</p>    
        </div>
        
        <div id="profileActions">
            <a class="btn" href="{% url 'logout' %}">Logg ut</a>
            <a class="btn" href="" onclick="alert('Denne funksjonaliteten er ikke implentert enda...')">Endre profil</a>
            <a class="btn" href="{% url 'new_post' %}">Legg til ny annonse</a>
        </div>
        
        <div id="profilePosts">
            <hr>
            {% if rent_requests.count > 0 %}
                <h3 class="accordion">Utleie forespørsler<span>▲</span></h3>
                <table class="request_container">
                    <thead>
                        <tr>
                            <th>Annonse</th>
                            <th>Leietaker</th>
                            <th>Tidsrom</th>
                            <th>Beskrivelse</th>
                            <th>Handlinger</th>
                        </tr>
                    </thead>
                    <tbody>
                    {% for rent_request in rent_requests %}
                        <tr>
                            <td><a href="/posts/{{ rent_request.post.id }}">{{ rent_request.post.title }}</a></td>
                            <td>{{ rent_request.renter.firstname }} {{ rent_request.renter.lastname }}</td>
                            <td>
                                Fra:
                                <br>
                                {{ rent_request.start_date.date|date:'Y-m-d' }}
                                <br>
                                Til:
                                <br>
                                {{ rent_request.end_date.date|date:'Y-m-d' }}
                            </td>
                            <td class="rent_request_desc">{{ rent_request.description }}</td>
                            <td class="rent_request_actions">
                                <div>
                                    <a class="btn" href="{% url 'acceptRental' rent_request.id %}">Godkjenn</a>
                                    <a class="btn" href="{% url 'rejectRental' rent_request.id %}">Avslå</a>
                                </div>
                            </td>
                        </tr>

                        <!--<div class="single_post">
                            {% if request.post.image %}
                                <img src="{{ request.post.image.url }}" alt="{{ request.post.title }}">
                            {% endif %}
                            <h3>{{ request.post.title }}</h3>
                            <h3>Leietaker: {{ request.renter.firstname }} {{ request.renter.lastname }}</h3>
                            <h3>Leieperiode: </h3>
                            <h4>{{ request.start_date.date|date:'Y-m-d' }} - {{ request.end_date.date|date:'Y-m-d' }}</h4>
                            <h3>Bruk: {{ request.description }} </h3>
                            <a class="btn endRental" href="">Avslå</a>
                            <a class="btn endRental" href="">Godkjenn</a>
                        </div>-->
                    {% endfor %}
                    </tbody>
                </table>
                <hr>
            {% endif %}
            {% if rentals.count > 0 %}
                <h3 class="accordion">Du leier<span>▲</span></h3>
                <div class="posts_container">
                    {% for rental in rentals %}
                        <div class="single_post">
                            {% if rental.post.image %}
                                <img src="{{ rental.post.image.url }}" alt="{{ rental.post.title }}">
                            {% endif %}
                            <h3>{{ rental.post.title }}</h3>
                            <p>Leid av: {{ rental.post.author.firstname }} {{ rental.post.author.lastname }}</p>
                            <a class="btn endRental" href="{% url 'endRental' rental.post.id %}">Avslutt leie</a>
                            <a href="/posts/{{ rental.post.id }}"></a>
                        </div>
                    {% endfor %}
                </div>
                <hr>
            {% endif %}
            <h3 class="accordion">Dine annonser<span>▲</span></h3>
            <div class="posts_container">
                {% if posts.count == 0 %}
                    <p>Du har ingen annonser enda...</p>
                {% else %}
                    {% for post in posts %}
                        <div class="single_post">
                            {% if post.image %}
                                <img src="{{ post.image.url }}" alt="{{ post.title }}">
                            {% endif %}
                            <h3>{{ post.title }}</h3>
                            <a class="btn" href="{% url 'new_post' post.id %}">Endre</a>
                            <a href="/posts/{{ post.id }}"></a>
                        </div>
                    {% endfor %}
                {% endif %}
            </div>
            <hr>
        </div>
    </div>
    
{% endblock %}